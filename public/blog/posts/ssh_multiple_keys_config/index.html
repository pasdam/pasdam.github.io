<!doctype html><html lang=en><head><meta charset=utf-8><title>How to use different SSH keys &ndash; /dev/null
</title><link href="https://fonts.googleapis.com/css?family=Work+Sans:600|Quattrocento+Sans:400,400i,700" rel=stylesheet type=text/css><link rel=icon href=https://pasdam.github.io/favicon.svg><link rel=stylesheet href=https://pasdam.github.io/global.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin=anonymous referrerpolicy=no-referrer><meta name=description content="Tutorial on how to use different SSH keys for different domains"><meta name=viewport content="width=device-width,initial-scale=1"><script async src="https://www.googletagmanager.com/gtag/js?id=G-H52BY7123V"></script><script async src=https://pasdam.github.io/copy-code-button.min.js onload='setupCopyButtons("copy","copied!")'></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-H52BY7123V",{cookie_domain:"pasdam.github.io",cookie_flags:"SameSite=None;Secure"})</script><link href=https://cdn.jsdelivr.net/npm/shareon@2/dist/shareon.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/shareon@2/dist/shareon.iife.js defer init></script></head><body><header id=page-header class=bg-green><nav><div class=logo-container><h1 class=logo><a href=/>/dev/null - Blog</a></h1></div><script>function toggleClassNameById(e,t){const n=document.getElementById(e).classList;n.contains(t)?n.remove(t):n.add(t)}</script><button data-collapse-toggle=mega-menu type=button class=mega-menu-toggle aria-controls=mega-menu aria-expanded=false onclick='toggleClassNameById("mega-menu","hidden")'>
<span class=sr-only>Open main menu</span><svg class="icon" aria-hidden="true" fill="none" viewBox="0 0 17 14"><path stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/></svg></button><div id=mega-menu><ul><li><a href=/><span>Home</span></a></li><li><a aria-current=true class=ancestor href=/blog/posts/><span>Blog</span></a></li><li><a href=https://github.com/pasdam target=_blank><i class="fa-brands fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/pasdam target=_blank><i class="fa-brands fa-linkedin"></i></a></li></ul></div></nav></header><div id=main><article class=post-body><h1 class=text-green>How to use different SSH keys</h1><p class=date-read-time>December 12, 2018 &mdash; 2 Min Read</p><div class=tags><div class=tag><a href=/tags/bash/ class=test>Bash</a></div><div class=tag><a href=/tags/openssl/ class=test>OpenSSL</a></div><div class=tag><a href=/tags/ssh/ class=test>SSH</a></div><div class=tag><a href=/tags/tutorial/ class=test>Tutorial</a></div></div><hr><nav id=TableOfContents><ul><li><a href=#requirements>Requirements</a></li><li><a href=#creates-keys>Creates keys</a></li><li><a href=#configure-ssh>Configure SSH</a></li></ul></nav><hr><div class=content><p>As a developer you might have to deal with SSH keys to access specific API/machines, and a common approach is to have one key for everything. For security reasons it&rsquo;s good to use different ones so that if one of them is compromised the other services are safe and you don&rsquo;t need to revoke and regenerate the keys for all your API/machines.</p><p>In this guide I will show you how to use a different SSH keys for each domain.</p><h2 id=requirements>Requirements</h2><ul><li>SSH.</li></ul><h2 id=creates-keys>Creates keys</h2><p>Following <a href=https://linux-audit.com/using-ed25519-openssh-keys-instead-of-dsa-rsa-ecdsa/ rel=external target=_blank>best practices</a>, you should always favor <a href=https://en.wikipedia.org/wiki/EdDSA rel=external target=_blank>ED25519</a> SSH keys, since they are more secure and have better performance over the other types.</p><p>The command is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen -t ed25519 -C <span style=color:#e6db74>&#34;email@example.com&#34;</span>
</span></span></code></pre></div><p>In order to have a different key for each domain, my pattern is actually:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen -t ed25519 -C <span style=color:#e6db74>&#34;&lt;my_name&gt;@&lt;domain&gt;&#34;</span>
</span></span></code></pre></div><p>for example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh-keygen -t ed25519 -C <span style=color:#e6db74>&#34;pasdam@mydomain.com&#34;</span>
</span></span><span style=display:flex><span>Generating public/private ed25519 key pair.
</span></span><span style=display:flex><span>Enter file in which to save the key <span style=color:#f92672>(</span>/Users/username/.ssh/id_ed25519<span style=color:#f92672>)</span>: /Users/username/.ssh/mydomain.com
</span></span><span style=display:flex><span>Enter passphrase <span style=color:#f92672>(</span>empty <span style=color:#66d9ef>for</span> no passphrase<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>Enter same passphrase again:
</span></span><span style=display:flex><span>Your identification has been saved in /Users/username/.ssh/mydomain.com.
</span></span><span style=display:flex><span>Your public key has been saved in /Users/username/.ssh/mydomain.com.pub.
</span></span></code></pre></div><p>For an extra layer of security you could specify a password for the private key, but that would mean to have to enter it everytime you want to use the key.</p><p>If you prefer the old RSA keys, because for instance you have to login on a legacy system that doesn&rsquo;t support <a href=https://en.wikipedia.org/wiki/EdDSA rel=external target=_blank>ED25519</a>, you can generate the key pair with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen -o -t rsa -b <span style=color:#ae81ff>4096</span> -C <span style=color:#e6db74>&#34;email@example.com&#34;</span>
</span></span></code></pre></div><p>Once created the key pair, you can store the public one into the service/server you want to access.</p><p>For instance to open an SSH connection to a VPS just run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh &lt;username&gt;@&lt;domain_or_ip&gt; -i &lt;private_key&gt;
</span></span></code></pre></div><p>i.e.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh pasdam@mydomain.com -i ~/.ssh/mydomain.com
</span></span></code></pre></div><p>Note: if you only have one key, the last part (<code>-i ~/.ssh/mydomain.com</code>) is not needed.</p><h2 id=configure-ssh>Configure SSH</h2><p>Instead of specifying for each domain which key to use every time we use the <code>ssh</code> command, we can configure it to automatically load the correct one.</p><p>To do so, we need to create/edit the file <a href=https://www.ssh.com/ssh/config/ rel=external target=_blank>~/.ssh/config</a>. In it there should be an entry for each domain/host:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>IdentityFile ~/.ssh/deault
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host github.com
</span></span><span style=display:flex><span>  HostName github.com
</span></span><span style=display:flex><span>  AddKeysToAgent yes
</span></span><span style=display:flex><span>  UseKeychain yes
</span></span><span style=display:flex><span>  IdentityFile ~/.ssh/github
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host mydomain1.com
</span></span><span style=display:flex><span>  HostName mydomain1.com
</span></span><span style=display:flex><span>  AddKeysToAgent yes
</span></span><span style=display:flex><span>  UseKeychain yes
</span></span><span style=display:flex><span>  User myuser
</span></span><span style=display:flex><span>  IdentityFile ~/.ssh/mydomain1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host mydomain2.com
</span></span><span style=display:flex><span>  HostName mydomain2.com
</span></span><span style=display:flex><span>  AddKeysToAgent yes
</span></span><span style=display:flex><span>  UseKeychain yes
</span></span><span style=display:flex><span>  User myuser
</span></span><span style=display:flex><span>  IdentityFile ~/.ssh/mydomain2
</span></span></code></pre></div><p>To note, for some hosts the username is specified, so that it would be possible to create an ssh connection using only the domain, like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh mydomain1.com
</span></span></code></pre></div><p>instead of:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh myuser@mydomain1.com
</span></span></code></pre></div></div></article><hr><div class=related><h3>See Also:</h3><ul><li><a href=/blog/posts/grpc_qt_go/>Use gRPC/protobuf with C++ and Go</a></li></ul></div><hr><div class=socialshare><p>Share this</p><div class=shareon><a class=facebook title="Share on Facebook"></a><a class=linkedin title="Share on Linkedin"></a><a class=mastodon title="Share on Mastodon"></a><a class=messenger data-fb-app-id=0123456789012345 title="Share on Messenger"></a><a class=pinterest title="Share on Pinterest"></a><a class=pocket title="Share on Pocket"></a><a class=reddit title="Share on Reddit"></a><a class=telegram title="Share on Telegram"></a><a class=twitter title="Share on Twitter"></a><a class=vkontakte title="Share on Vkontakte"></a><a class=whatsapp title="Share on Whatsapp"></a><a class=copy-url title="Copy link"></a><a class=email title="Share by Email"></a><a class=print title=Print></a></div></div><hr><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//pasdam-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
<button class=hidden id=to-top-button onclick=goToTop() title="Go To Top">
<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-circle-up" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M8 256C8 119 119 8 256 8s248 111 248 248-111 248-248 248S8 393 8 256zm231-113.9L103.5 277.6c-9.4 9.4-9.4 24.6.0 33.9l17 17c9.4 9.4 24.6 9.4 33.9.0L256 226.9l101.6 101.6c9.4 9.4 24.6 9.4 33.9.0l17-17c9.4-9.4 9.4-24.6.0-33.9L273 142.1c-9.4-9.4-24.6-9.4-34 0z"/></svg>
</button>
<script async>const offset=100;var toTopButton=document.getElementById("to-top-button");window.onscroll=function(){document.body.scrollTop>offset||document.documentElement.scrollTop>offset?toTopButton.classList.remove("hidden"):toTopButton.classList.add("hidden")};function goToTop(){window.scrollTo({top:0,behavior:"smooth"})}</script></body></html>